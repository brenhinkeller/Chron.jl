## --- Test bilinear exponential function

    d = BilinearExponential([-4.265260194845627, 66.00606672179812, 0.17739474265630253, 70.57882331291309, 0.6017142541555505])
    @test d isa BilinearExponential{Float64}
    @test pdf(d, 66.02) ≈ 0.0005437680417927236
    @test logpdf(d, 66.02) ≈ (-3.251727600957773 -4.265260194845627)
    @test pdf.(d, [66.02, 66.08, 66.15]) ≈ [0.0005437680417927236, 5.505685686251538e-13, 5.610687893459488e-28]
    @test cdf.(d, [10, 66.02, 66.08, 66.15, 100]) ≈ [0, 0.9999979646869678, 0.9999999999999903, 1.0000000000000446, 1]
    @test ccdf.(d, [10, 66.02, 66.08, 66.15, 100]) ≈ [1, 2.035313044102181e-6, 1.2768666553428429e-15, 1.0225965286520566e-30, 0]
    @test logcdf.(d, [10, 66.02, 66.08, 66.15, 100]) ≈  [-13366.73582762445, -2.035315134207849e-6, 6.394884621840902e-14, 3.4638958368304884e-14, 0.0]
    @test logccdf.(d, [10, 66.02, 66.08, 66.15, 100]) ≈ [0.0, -13.10486092087404, -34.29436724356088, -69.05520778079227, -22437.23853845797]


    @test eltype(d) === partype(d) === Float64
    @test params(d) == (-4.265260194845627, 66.00606672179812, 0.17739474265630253, 70.57882331291309, 0.6017142541555505)
    @test d + 1 isa BilinearExponential{Float64}
    @test location(d + 1) == 66.00606672179812 + 1
    @test d * 2 isa BilinearExponential{Float64}
    @test location(d * 2) == 66.00606672179812 * 2
    @test scale(d * 2) == 0.17739474265630253 * 2

    d = BilinearExponential(66.00606672179812, 0.17739474265630253, 70.57882331291309, 0.6017142541555505)
    @test mean(d) ≈ 65.93219453443876 atol = 1e-6
    @test var(d) ≈ 0.02080666596420308^2 atol = 1e-6
    @test std(d) ≈ 0.02080666596420308 atol = 1e-6
    @test skewness(d) ≈ -0.16449904171203025 atol = 1e-6
    @test kurtosis(d) ≈ 3.0865922917156188 atol = 1e-6

## --- Test Radiocarbon distribution

    d = Radiocarbon(1000, 10, intcal13)
    @test d isa Radiocarbon{Float64}
    @test pdf(d, 950) ≈ 0.0036210273644940918
    @test logpdf(d, 950) ≈ -3.4446721311475414 
    @test pdf.(d, [900, 950, 1000]) ≈ [3.372067127114498e-7, 0.0036210273644940918, 1.5582187464154278e-12]

    @test eltype(d) === partype(d) === Float64
    @test location(d) ≈ 927.2875322569857
    @test scale(d) ≈ 7.412902965559571

    @test mean(d) ≈ 927.2875322569857
    @test var(d) ≈ 7.412902965559571^2
    @test std(d) ≈ 7.412902965559571

## --- Other utility functions for log likelihoods

    @test strat_ll(66.02, BilinearExponential(-5.9345103368858085, 66.00606672179812, 0.17739474265630253, 70.57882331291309, 0.6017142541555505)) ≈  (-3.251727600957773 -5.9345103368858085)
    @test strat_ll(950, Radiocarbon(1000, 10, intcal13)) ≈ -3.4446721311475414 

    @test strat_ll([0.0, 0.0], [Normal(0,1), Normal(0,1)]) ≈ 0
    @test strat_ll([0.0, 0.5], [Normal(0,1), Uniform(0,1)]) ≈ -0.9189385332046728
    @test strat_ll([0.0, 0.5, 66.02], [Normal(0,1), Uniform(0,1), BilinearExponential(-5.9345103368858085, 66.00606672179812, 0.17739474265630253, 70.57882331291309, 0.6017142541555505)]) ≈ (-0.9189385332046728 -3.251727600957773 -5.9345103368858085)
    @test strat_ll([0.0, 0.5, 66.02, 900], [Normal(0,1), Uniform(0,1), BilinearExponential(-5.9345103368858085, 66.00606672179812, 0.17739474265630253, 70.57882331291309, 0.6017142541555505), Radiocarbon(1000, 10, intcal13)]) ≈ -22.831420814939655

## ---
