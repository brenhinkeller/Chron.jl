## --- Test bilinear exponential function

    d = BilinearExponential([-4.265260194845627, 66.00606672179812, 0.17739474265630253, 70.57882331291309, 0.6017142541555505])
    @test d isa BilinearExponential{Float64}
    @test pdf(d, 66.02) ≈ 0.0005437680417927236
    @test logpdf(d, 66.02) ≈ (-3.251727600957773 -4.265260194845627)
    @test pdf.(d, [66.02, 66.08, 66.15]) ≈ [0.0005437680417927236, 5.505685686251538e-13, 5.610687893459488e-28]
    @test cdf.(d, [10, 66.02, 66.08, 66.15, 100]) ≈ [0, 0.9999979646869678, 0.9999999999999903, 1.0000000000000446, 1]
    @test ccdf.(d, [10, 66.02, 66.08, 66.15, 100]) ≈ [1, 2.035313044102181e-6, 1.2768666553428429e-15, 1.0225965286520566e-30, 0]
    @test logcdf.(d, [10, 66.02, 66.08, 66.15, 100]) ≈  [-13366.73582762445, -2.035315134207849e-6, 6.394884621840902e-14, 3.4638958368304884e-14, 0.0]
    @test logccdf.(d, [10, 66.02, 66.08, 66.15, 100]) ≈ [0.0, -13.10486092087404, -34.29436724356088, -69.05520778079227, -22437.23853845797]


    @test eltype(d) === partype(d) === Float64
    @test params(d) == (-4.265260194845627, 66.00606672179812, 0.17739474265630253, 70.57882331291309, 0.6017142541555505)
    @test d + 1 isa BilinearExponential{Float64}
    @test location(d + 1) == 66.00606672179812 + 1
    @test d * 2 isa BilinearExponential{Float64}
    @test location(d * 2) == 66.00606672179812 * 2
    @test scale(d * 2) == 0.17739474265630253 * 2

    d = BilinearExponential(66.00606672179812, 0.17739474265630253, 70.57882331291309, 0.6017142541555505)
    @test mean(d) ≈ 65.93219453443876 atol = 1e-6
    @test var(d) ≈ 0.02080666596420308^2 atol = 1e-6
    @test std(d) ≈ 0.02080666596420308 atol = 1e-6
    @test skewness(d) ≈ -0.16449904171203025 atol = 1e-6
    @test kurtosis(d) ≈ 0.0865922917156188 atol = 1e-6

## --- Test Radiocarbon distribution

    d = Radiocarbon(1000, 10, intcal13)
    @test d isa Radiocarbon{Float64}
    @test pdf(d, 950) ≈ 0.0006472245090905895
    @test logpdf(d, 950) ≈ -7.342817323513984
    @test pdf.(d, [900, 950, 1000]) ≈ [6.333126104255167e-8, 0.0006472245090905895, 2.652591331229418e-13]
    @test cdf.(d, [-1, 900, 950, 1000, 1e5]) ≈ [0.0, 0.000563737957020387, 0.18096988328291203, 0.18312332434946413, 1.0]
    @test ccdf.(d, [-1, 900, 950, 1000, 1e5]) ≈ [1.0, 0.18255964979458322, 0.0028006656465210025, 7.114355524701459e-11, 0.0]
    @test logcdf.(d, [-1, 900, 950, 1000, 1e5]) ≈ [-7649.088264850034, -7.480921029645386, -1.7094246522629235, -1.6975954495627632, -0.0] 
    @test logccdf.(d, [-1, 900, 950, 1000, 1e5]) ≈ [-0.0, -1.700678311173327, -5.8778981591541335, -23.366321375298313, -8.706770436253259e7]

    @test eltype(d) === partype(d) === Float64
    @test location(d) ≈ 927.2556461305643
    @test scale(d) ≈ 7.5077650707247

    @test mean(d) ≈ 927.2556461305643
    @test var(d) ≈ 7.5077650707247^2
    @test std(d) ≈ 7.5077650707247
    @test skewness(d) ≈ -4.6327184250788696
    @test kurtosis(d) ≈ 67.68860469654331

## --- Other utility functions for log likelihoods

    @test strat_ll([66.02,], [BilinearExponential(-5.9345103368858085, 66.00606672179812, 0.17739474265630253, 70.57882331291309, 0.6017142541555505)]) ≈  (-3.251727600957773 -5.9345103368858085)
    @test strat_ll([950,], [Radiocarbon(1000, 10, intcal13)]) ≈ -7.342817323513984

    @test strat_ll([0.0, 0.0], [Normal(0,1), Normal(0,1)]) ≈ 0
    @test strat_ll([0.0, 0.5], [Normal(0,1), Uniform(0,1)]) ≈ 0
    @test strat_ll([0.0, 0.5, 66.02], [Normal(0,1), Uniform(0,1), BilinearExponential(-5.9345103368858085, 66.00606672179812, 0.17739474265630253, 70.57882331291309, 0.6017142541555505)]) ≈ (-3.251727600957773 -5.9345103368858085)
    @test strat_ll([0.0, 0.5, 66.02, 900], [Normal(0,1), Uniform(0,1), BilinearExponential(-5.9345103368858085, 66.00606672179812, 0.17739474265630253, 70.57882331291309, 0.6017142541555505), Radiocarbon(1000, 10, intcal13)]) ≈ -25.761124712213704

## ---
